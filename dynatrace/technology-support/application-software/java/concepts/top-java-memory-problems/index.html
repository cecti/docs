



<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="ja">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../../../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>常见的 Java 内存问题 - 欢迎来到 Dynatrace 帮助中心</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/application.0284f74d.css">
      
      
    
    
      <script src="../../../../../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#java" tabindex="1" class="md-skip">
        跳转至
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../../.." title="欢迎来到 Dynatrace 帮助中心" class="md-header-nav__button md-logo">
          
            <img src="../../../../../assets/images/logo.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              欢迎来到 Dynatrace 帮助中心
            </span>
            <span class="md-header-nav__topic">
              
                常见的 Java 内存问题
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../../.." title="欢迎来到 Dynatrace 帮助中心" class="md-nav__button md-logo">
      
        <img src="../../../../../assets/images/logo.svg" width="48" height="48">
      
    </a>
    欢迎来到 Dynatrace 帮助中心
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      快速入门
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        快速入门
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../get-started/what-is-dynatrace/" title="什么是 Dynatrace？" class="md-nav__link">
      什么是 Dynatrace？
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../get-started/get-started-with-dynatrace-saas/" title="Dynatrace SaaS" class="md-nav__link">
      Dynatrace SaaS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../get-started/get-started-with-dynatrace-managed/" title="Dynatrace Managed" class="md-nav__link">
      Dynatrace Managed
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      最新动态
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        最新动态
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      Release notes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        Release notes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-1-1" type="checkbox" id="nav-2-1-1">
    
    <label class="md-nav__link" for="nav-2-1-1">
      OneAgent
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-2-1-1">
        OneAgent
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../whats-new/release-notes/oneagent/sprint-171/" title="Version 1.171" class="md-nav__link">
      Version 1.171
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      支持的技术
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        支持的技术
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      云平台
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        云平台
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-1" type="checkbox" id="nav-3-1-1">
    
    <label class="md-nav__link" for="nav-3-1-1">
      AWS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-1">
        AWS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-1-1" type="checkbox" id="nav-3-1-1-1">
    
    <label class="md-nav__link" for="nav-3-1-1-1">
      安装
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-1-1-1">
        安装
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../cloud-platforms/amazon-web-services/installation/aws-monitoring-with-dynatrace-managed/" title="为 AWS 设置 Dynatrace Managed 监控" class="md-nav__link">
      为 AWS 设置 Dynatrace Managed 监控
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-1-2" type="checkbox" id="nav-3-1-1-2">
    
    <label class="md-nav__link" for="nav-3-1-1-2">
      运维
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-1-1-2">
        运维
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../cloud-platforms/amazon-web-services/operation/connect-to-dynatrace-using-aws-privatelink/" title="使用 AWS PrivateLink 连接到 Dynatrace" class="md-nav__link">
      使用 AWS PrivateLink 连接到 Dynatrace
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-2" type="checkbox" id="nav-3-1-2">
    
    <label class="md-nav__link" for="nav-3-1-2">
      Azure
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-1-2">
        Azure
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-2-1" type="checkbox" id="nav-3-1-2-1">
    
    <label class="md-nav__link" for="nav-3-1-2-1">
      Azure services
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-1-2-1">
        Azure services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1-2-1-1" type="checkbox" id="nav-3-1-2-1-1">
    
    <label class="md-nav__link" for="nav-3-1-2-1-1">
      虚拟机
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="5">
      <label class="md-nav__title" for="nav-3-1-2-1-1">
        虚拟机
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../cloud-platforms/microsoft-azure/azure-services/virtual-machines/deploy-oneagent-on-azure-virtual-machines/" title="在 Azure 虚拟机上部署 OneAgent" class="md-nav__link">
      在 Azure 虚拟机上部署 OneAgent
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2" checked>
    
    <label class="md-nav__link" for="nav-3-2">
      应用软件
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        应用软件
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2-1" type="checkbox" id="nav-3-2-1" checked>
    
    <label class="md-nav__link" for="nav-3-2-1">
      Java
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-3-2-1">
        Java
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2-1-1" type="checkbox" id="nav-3-2-1-1">
    
    <label class="md-nav__link" for="nav-3-2-1-1">
      支持
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-2-1-1">
        支持
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../support/support-for-jvms/" title="支持 JVM" class="md-nav__link">
      支持 JVM
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2-1-2" type="checkbox" id="nav-3-2-1-2" checked>
    
    <label class="md-nav__link" for="nav-3-2-1-2">
      概念
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-2-1-2">
        概念
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../g1-garbage-collector-java-9/" title="G1 垃圾收集器 - Java 9" class="md-nav__link">
      G1 垃圾收集器 - Java 9
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        常见的 Java 内存问题
      </label>
    
    <a href="./" title="常见的 Java 内存问题" class="md-nav__link md-nav__link--active">
      常见的 Java 内存问题
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="内存泄漏" class="md-nav__link">
    内存泄漏
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="内存使用率高" class="md-nav__link">
    内存使用率高
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#class-loader" title="与内存相关的 Class Loader 问题" class="md-nav__link">
    与内存相关的 Class Loader 问题
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2-1-3" type="checkbox" id="nav-3-2-1-3">
    
    <label class="md-nav__link" for="nav-3-2-1-3">
      配置和分析
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-3-2-1-3">
        配置和分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../configuration-and-analysis/identify-memory-leaks/" title="识别内存泄漏" class="md-nav__link">
      识别内存泄漏
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../configuration-and-analysis/define-custom-java-services/" title="定义 Java 服务" class="md-nav__link">
      定义 Java 服务
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../php/" title="PHP" class="md-nav__link">
      PHP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../nodejs/" title="Node.js" class="md-nav__link">
      Node.js
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../dotnet/" title=".NET" class="md-nav__link">
      .NET
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../go/" title="Go" class="md-nav__link">
      Go
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../nginx/" title="NGINX" class="md-nav__link">
      NGINX
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      安装配置
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        安装配置
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../.." title="Dynatrace SaaS" class="md-nav__link">
      Dynatrace SaaS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Dynatrace Managed
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Dynatrace Managed
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-1" type="checkbox" id="nav-4-2-1">
    
    <label class="md-nav__link" for="nav-4-2-1">
      基本概念
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-1">
        基本概念
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../setup-and-configuration/dynatrace-managed/basic-concepts/overview-of-dynatracce-managed/" title="Dynatrace Managed 组件概述" class="md-nav__link">
      Dynatrace Managed 组件概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../setup-and-configuration/dynatrace-managed/basic-concepts/dynatrace-managed-cluster-failover-mechanism/" title="Dynatrace Mangged 故障恢复机制" class="md-nav__link">
      Dynatrace Mangged 故障恢复机制
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2-2" type="checkbox" id="nav-4-2-2">
    
    <label class="md-nav__link" for="nav-4-2-2">
      安装
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-2-2">
        安装
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../setup-and-configuration/dynatrace-managed/installation/managed-deployment-scenarios/" title="Managed 部署方案" class="md-nav__link">
      Managed 部署方案
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../setup-and-configuration/dynatrace-managed/installation/dynatrace-managed-hardware-and-system-requirements/" title="Dynatrace Managed 硬件和系统要求" class="md-nav__link">
      Dynatrace Managed 硬件和系统要求
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../setup-and-configuration/dynatrace-managed/installation/set-up-a-cluster/" title="设置群集" class="md-nav__link">
      设置群集
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../setup-and-configuration/dynatrace-managed/installation/add-a-new-cluster-node/" title="添加新的群集节点" class="md-nav__link">
      添加新的群集节点
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../setup-and-configuration/dynatrace-managed/installation/customize-installation-for-dynatrace-managed/" title="自定义安装 Dynatrace Managed" class="md-nav__link">
      自定义安装 Dynatrace Managed
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../setup-and-configuration/dynatrace-managed/installation/how-to-install-a-cluster-activegate/" title="如何安装 Cluster ActiveGate" class="md-nav__link">
      如何安装 Cluster ActiveGate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../setup-and-configuration/dynatrace-managed/installation/install-your-own-ssl-certificate/" title="安装自己的 SSL 证书" class="md-nav__link">
      安装自己的 SSL 证书
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      扩展 Dynatrace
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        扩展 Dynatrace
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../extend-dynatrace/dynatrace-api.md" title="dynatrace-api" class="md-nav__link">
      dynatrace-api
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../extend-dynatrace/dynatrace-sdks.md" title="dynatrace-sdks" class="md-nav__link">
      dynatrace-sdks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../extend-dynatrace/plugins.md" title="plugins" class="md-nav__link">
      plugins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../extend-dynatrace/custom-metric-ingestion-and-analysis.md" title="自定义指标接入及分析" class="md-nav__link">
      自定义指标接入及分析
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      如何使用 Dynatrace
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        如何使用 Dynatrace
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/cloud-platforms/" title="云平台" class="md-nav__link">
      云平台
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      真实用户监控
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        真实用户监控
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-1" type="checkbox" id="nav-6-2-1">
    
    <label class="md-nav__link" for="nav-6-2-1">
      基本的 RUM 概念
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-2-1">
        基本的 RUM 概念
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/real-user-monitoring/basic-concepts/applications/" title="应用" class="md-nav__link">
      应用
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/real-user-monitoring/basic-concepts/user-actions/" title="用户操作" class="md-nav__link">
      用户操作
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/real-user-monitoring/basic-concepts/user-session/" title="用户会话" class="md-nav__link">
      用户会话
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/real-user-monitoring/basic-concepts/user-action-metrics/" title="用户操作指标" class="md-nav__link">
      用户操作指标
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/real-user-monitoring/basic-concepts/rum-javascript-injection/" title="RUM JavaScript 注入" class="md-nav__link">
      RUM JavaScript 注入
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/real-user-monitoring/basic-concepts/detection-of-ip-addresses-locations-and-user-agents/" title="检测 IP 地址，地理位置和用户代理" class="md-nav__link">
      检测 IP 地址，地理位置和用户代理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-1-7" type="checkbox" id="nav-6-2-1-7">
    
    <label class="md-nav__link" for="nav-6-2-1-7">
      Dynatrace 得分和评分
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-6-2-1-7">
        Dynatrace 得分和评分
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/real-user-monitoring/basic-concepts/ratings/apdex-ratings/" title="Apdex 评分" class="md-nav__link">
      Apdex 评分
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/real-user-monitoring/basic-concepts/session-replay/" title="会话重播" class="md-nav__link">
      会话重播
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-2" type="checkbox" id="nav-6-2-2">
    
    <label class="md-nav__link" for="nav-6-2-2">
      RUM 的设置和配置
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-2-2">
        RUM 的设置和配置
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-2-1" type="checkbox" id="nav-6-2-2-1">
    
    <label class="md-nav__link" for="nav-6-2-2-1">
      Web应该用程序
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-6-2-2-1">
        Web应该用程序
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-2-1-1" type="checkbox" id="nav-6-2-2-1-1">
    
    <label class="md-nav__link" for="nav-6-2-2-1-1">
      初始配置
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="5">
      <label class="md-nav__title" for="nav-6-2-2-1-1">
        初始配置
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/real-user-monitoring/setup-and-configuration/web-applications/initial-configuration/define-your-applications-via-the-my-web-application-placeholder/" title="通过“My web application”占位符定义您的应用程序" class="md-nav__link">
      通过“My web application”占位符定义您的应用程序
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3" type="checkbox" id="nav-6-3">
    
    <label class="md-nav__link" for="nav-6-3">
      数据库
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-3">
        数据库
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3-1" type="checkbox" id="nav-6-3-1">
    
    <label class="md-nav__link" for="nav-6-3-1">
      介绍
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-3-1">
        介绍
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/databases/introduction/how-database-activity-is-monitored/" title="如何监视数据库活动" class="md-nav__link">
      如何监视数据库活动
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/databases/introduction/support-for-sql-bind-variables/" title="支持 SQL 绑定变量" class="md-nav__link">
      支持 SQL 绑定变量
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-3-2" type="checkbox" id="nav-6-3-2">
    
    <label class="md-nav__link" for="nav-6-3-2">
      分析
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-3-2">
        分析
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/databases/analysis/analyze-database-services/" title="分析数据库服务" class="md-nav__link">
      分析数据库服务
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4" type="checkbox" id="nav-6-4">
    
    <label class="md-nav__link" for="nav-6-4">
      进程组
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-4">
        进程组
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-4-1" type="checkbox" id="nav-6-4-1">
    
    <label class="md-nav__link" for="nav-6-4-1">
      基本概念
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-4-1">
        基本概念
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/process-groups/basic-concepts/which-are-the-most-important-processes/" title="哪个是最重要的进程" class="md-nav__link">
      哪个是最重要的进程
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5" type="checkbox" id="nav-6-5">
    
    <label class="md-nav__link" for="nav-6-5">
      主机
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-5">
        主机
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5-1" type="checkbox" id="nav-6-5-1">
    
    <label class="md-nav__link" for="nav-6-5-1">
      基本概念
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-5-1">
        基本概念
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/hosts/basic-concepts/get-started-with-infrastructure-monitoring/" title="开始使用基础设施监控" class="md-nav__link">
      开始使用基础设施监控
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/hosts/basic-concepts/how-effective-is-infrastructure-monitoring-on-its-own/" title="基础设施监控效果如何" class="md-nav__link">
      基础设施监控效果如何
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5-2" type="checkbox" id="nav-6-5-2">
    
    <label class="md-nav__link" for="nav-6-5-2">
      配置
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-5-2">
        配置
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/hosts/configuration/organize-your-environment-using-host-groups/" title="使用主机组组织环境" class="md-nav__link">
      使用主机组组织环境
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/hosts/configuration/set-custom-host-names-in-dynamic-environments/" title="在动态环境中设置自定义主机名" class="md-nav__link">
      在动态环境中设置自定义主机名
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/hosts/configuration/define-tags-and-metadata-for-hosts/" title="为主机定义标签和元数据" class="md-nav__link">
      为主机定义标签和元数据
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-5-3" type="checkbox" id="nav-6-5-3">
    
    <label class="md-nav__link" for="nav-6-5-3">
      监控
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-5-3">
        监控
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/hosts/monitoring/measures-for-host-health/" title="主机健康测量" class="md-nav__link">
      主机健康测量
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/hosts/monitoring/where-can-i-view-host-performance-measures/" title="我在哪里可以查看主机性能指标" class="md-nav__link">
      我在哪里可以查看主机性能指标
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-6" type="checkbox" id="nav-6-6">
    
    <label class="md-nav__link" for="nav-6-6">
      标签和元数据
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-6">
        标签和元数据
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-6-1" type="checkbox" id="nav-6-6-1">
    
    <label class="md-nav__link" for="nav-6-6-1">
      基本概念
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-6-1">
        基本概念
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/tags-and-metadata/basic-concepts/tags-vs-metadata/" title="标签和元数据" class="md-nav__link">
      标签和元数据
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/tags-and-metadata/basic-concepts/best-practices-and-recommendations-for-tagging/" title="标签的最佳实践和建议" class="md-nav__link">
      标签的最佳实践和建议
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-6-2" type="checkbox" id="nav-6-6-2">
    
    <label class="md-nav__link" for="nav-6-6-2">
      参考
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-6-2">
        参考
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/tags-and-metadata/reference/regular-expressions-in-dynatrace/" title="Dynatrace 中的正则表达式" class="md-nav__link">
      Dynatrace 中的正则表达式
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-6-3" type="checkbox" id="nav-6-6-3">
    
    <label class="md-nav__link" for="nav-6-6-3">
      建立
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-6-3">
        建立
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../how-to-use-dynatrace/tags-and-metadata/setup/how-to-define-tags/" title="如何定义标签" class="md-nav__link">
      如何定义标签
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      参考
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        参考
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../reference/dynatrace-web-ui-requirements/" title="Web UI 要求" class="md-nav__link">
      Web UI 要求
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../reference/monitoring-consumption-calculation/" title="监控消费计算" class="md-nav__link">
      监控消费计算
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">
    
    <label class="md-nav__link" for="nav-7-3">
      Dynatrace 的概念
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-3">
        Dynatrace 的概念
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../reference/dynatrace-concepts/what-is-a-monitoring-environment/" title="什么是监控环境" class="md-nav__link">
      什么是监控环境
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../reference/dynatrace-concepts/what-is-an-access-token/" title="什么是访问令牌" class="md-nav__link">
      什么是访问令牌
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../为什么我需要环境 ID" title="None" class="md-nav__link">
      None
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../../我可以设置多个监控环境吗" title="None" class="md-nav__link">
      None
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" title="内存泄漏" class="md-nav__link">
    内存泄漏
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" title="内存使用率高" class="md-nav__link">
    内存使用率高
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#class-loader" title="与内存相关的 Class Loader 问题" class="md-nav__link">
    与内存相关的 Class Loader 问题
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="java">常见的 Java 内存问题</h1>
<p>本主题说明了经常发生的内存问题，例如内存泄漏，高内存使用，类加载器问题和 GC 配置。</p>
<h2 id="_1">内存泄漏</h2>
<p>最常见的内存泄漏问题是内存泄漏增加或泄漏对象不断增加。可以通过趋势或直方图转储轻松跟踪这些泄漏。</p>
<p>相比之下，单个对象泄漏的讨论较少。只要有足够的内存，单个内存泄漏很少会造成严重问题。但是，单个对象泄漏有时会占用大量内存并造成问题。好在堆分析器工具可以轻松识别单个大泄漏。</p>
<p>以下是内存泄漏的一些原因：</p>
<ul>
<li>线程局部变量</li>
</ul>
<p><code>ThreadLocal</code>变量用于将变量或状态绑定到线程。每个线程都有自己的变量实例。虽然<code>ThreadLocal</code>变量很有用，但它们也很危险。它们用于跟踪状态，例如当前的事务 ID，但有时会保存更多信息。</p>
<p>一个<code>ThreadLocal</code>变量是由它的线程引用其生命周期绑定到它。在大多数应用程序服务器中，线程通过线程池重用，并且永远不会被垃圾回收。如果应用程序代码没有仔细清除<code>ThreadLocal</code>变量，则会导致令人讨厌的内存泄漏。通过查看<code>ThreadLocalMap</code>和跟踪引用，可以通过堆转储轻松发现此类泄漏。</p>
<p><img alt="threadlocalmap" src="https://dt-cdn.net/images/heapdump-724-be171496c5.png" /></p>
<p>在上图中，heapdump 表示超过 4K 对象（大小约为 10MB）由<code>ThreadLocal</code>变量保存。线程的名称显示应用程序中负责泄漏的部分。</p>
<ul>
<li>可变的静态字段集合</li>
</ul>
<p>内存泄漏的最常见原因是静态的错误使用。静态变量由其类保存，随后由其类加载器保存。虽然一个类可以被垃圾收集，但它很少会在应用程序的生命周期中发生。通常，静态用于保存缓存信息或跨线程共享状态。如果不小心，很容易导致内存泄漏。因此，必须不惜一切代价避免使用静态可变集合。一个好的架构规则是根本不使用可变的静态对象，并寻求更好的替代方案。</p>
<ul>
<li>循环和复杂的双向引用</li>
</ul>
<p>请考虑以下示例：</p>
<p><code>code org.w3c.dom.Document doc = readXmlDocument(); org.w3c.dom.Node child = doc.getDocumentElement().getFirstChild(); doc.removeNode(child); doc = null;</code></p>
<p>在片段的最后，DOM 文档将被垃圾收集，但事实并非如此。DOM Node 对象始终属于 Document。即使从 Document 中删除，Node 对象也会引用其拥有的文档。只要保留子对象，Document 及其包含的所有节点都不会被垃圾回收。</p>
<ul>
<li>JNI 内存泄漏</li>
</ul>
<p>JNI 用于从 Java 调用本机代码。此本机代码可以处理、调用和创建 Java 对象。由本机方法创建的每个 Java 对象都以<code>local reference</code>的形式开始其生命周期，这意味着在本机方法返回之前将引用该对象。本机方法引用 Java 对象，因此没有问题，除非本机方法永远运行。在某些情况下，您可能希望保留已创建的对象，即使本机调用已经结束。要实现这一点，您可以确保它被其他 Java 对象引用，也可以将<code>local reference</code>更改为<code>global reference</code>。全局引用是 GC Root，在本机代码显式删除之前，它永远不会被垃圾收集。发现此类内存泄漏的唯一方法是使用一个堆转储工具，该工具显式地显示全局本机引用。如果必须使用 JNI，应该确保正常引用这些对象，并完全放弃全局引用。</p>
<p>当堆转储分析工具明确地将 GC Root 标记为本机引用时，您可以找到此类泄漏，否则将很难。</p>
<ul>
<li>错误的 equals/hashcode 实现</li>
</ul>
<p>如果 equals/hashcode 方法违反了 equals 契约，那么在 map 中作为键使用时会导致内存泄漏。HashMap 使用 hashcode 查找对象，并通过使用 equals 方法验证它是否找到了对象。如果两个对象相等，则它们必须具有相同的 hashcode，而不是相反。如果没有显式实现 hashcode，则不会出现这种情况。默认的 hashcode 基于对象标识。因此，通过使用一个无效  hashcode 实现的对象作为映射中的键，您可以添加一些内容，但是您将无法再找到它们。如果您选择重新添加它，它将不会覆盖旧项，而是添加一个新项，从而导致内存泄漏。随着它的成长，你会发现它的存在，但根本原因很难确定，除非你记得这个。</p>
<p>避免此类泄漏的最简单方法是使用单元测试用例和测试类的equals契约的可用框架之一。</p>
<ul>
<li>Classloader 泄露</li>
</ul>
<p>在应用程序服务器和 OSGi 容器中可以找到类加载器泄漏。类由类加载器引用，通常不会被垃圾收集，直到收集类加载器本身。但是，仅当应用程序被应用程序服务器或 OSGi 容器卸载时才会发生这种情况。以下是两种类型的类加载器泄漏：</p>
<ul>
<li>第一种形式是一个对象，它的类属于类加载器仍然由高速缓存，本地线程或其他方法引用。在这种情况下，整个应用程序的整个类加载器不能被垃圾回收。这发生在 OSGi 容器和JEE应用程序服务器中。这些内存泄漏不是太频繁，因为它们仅在卸载或重新部署应用程序时发生。</li>
<li>第二种形式是由字节码操作框架(如 BCEL 和 ASM)引入的。这些框架允许动态创建新类。当类被遗忘时，负责的代码可能多次创建用于相同目的的新类。该类是在当前类装入器中引用的，这就是为什么可能会出现内存泄漏，从而导致永久生成中出现内存不足的情况。大多数堆分析工具都没有指出这个问题，因此必须手动分析。这种形式的内存泄漏非常有名，因为旧版本的 hibernate 及其 CGLIB 的使用存在问题。</li>
</ul>
<h2 id="_2">内存使用率高</h2>
<p>在当今的企业应用程序中，过多的内存使用是一个日益频繁和严重的问题。虽然普通服务器通常具有 10GB，20GB 或更多内存，但高度并行性和缺乏意识会导致内存不足。另一个问题是虽然在今天的 JVM 中可以使用几千兆字节的内存，但副作用会导致非常长的 GC 暂停。在某些情况下，增加内存可能是内存泄漏或编写错误的软件的一种解决方法。但是，这往往会使事情从长远来看变得更糟，而不是更好。以下是高内存使用率的最常见原因：</p>
<ul>
<li>HTTP 会话作为缓存</li>
</ul>
<p>会话缓存反模式将 HTTP 会话误用为数据缓存。HTTP 会话用于存储用户数据或在单个 HTTP 请求中生存所需的状态。这称为会话状态，可以在处理非琐碎用户交互的 web 应用程序中找到这种状态。HTTP 会话有几个问题。</p>
<p>首先，由于可能有大量用户，一个 web 服务器可能有相当多的活动会话。因此，保持它们小是很重要的。第二个问题是，应用程序没有在给定的时间点具体地释放它们。相反，web 服务器有一个会话超时，这个超时通常非常高，以增加用户的舒适度。如果考虑到并行用户的数量，仅这一点就很容易导致大量内存需求。然而，实际上，HTTP 会话的大小通常是几兆字节。</p>
<p>这些缓存的发生是因为开发人员只需简单地将对象添加到会话中，而不是考虑其他解决方案（如缓存），这样很容易。这通常是在“即发即弃”模式下完成的，这意味着永远不会删除数据。</p>
<p>例如，存储在 HTML 选择字段中显示的数据，例如国家/地区列表。这个半静态数据的大小通常是几千字节，并且如果保留在会话中，则每个用户在堆中保存。最好将其存储在一个中央缓存中。另一个例子是滥用 hibernate 会话来管理会话状态。休眠会话存储在 HTTP 会话中，以便于快速访问数据。这意味着存储的状态远远超过所需的状态，并且只有几个用户，内存使用量会立即大大增加。在现代 Ajax 应用程序中，可以将会话状态转换为客户端。在理想情况下，这会导致无状态或状态差的服务器应用程序扩展得更好。</p>
<p>复制长 HTTP 会话也是另一个问题。</p>
<ul>
<li>缓存使用错误</li>
</ul>
<p>缓存通过仅加载一次数据来提高性能和可伸缩性。但是，过度使用缓存很快就会导致 Java 性能问题。除了典型的缓存问题（例如未命中和高周转）之外，缓存还可能导致高内存使用和过多的 GC 行为。这些问题通常是由于缓存过大造成的。但是，有时候问题就在某个地方。</p>
<p>软引用是一种特殊形式的对象引用。虽然软件引用可以随时由垃圾收集器决定释放，但它们实际上只是为了避免内存不足错误而被释放。在这方面，它们与弱引用有很大不同，弱引用永远不会阻止对象的垃圾收集。因此，软引用在高速缓存实现中非常流行。</p>
<p>缓存开发人员正确地假定在内存不足的情况下释放缓存数据。如果缓存配置不正确，它将快速无限增长，直到内存已满。启动 GC 时，将清除缓存中的所有软引用并清除其对象的垃圾。内存使用量回落到基准级别，只是开始再次增长。这种现象很容易被误认为是一个配置不正确的年轻一代。看起来这些物品的使用时间太早，只能由下一个主要 GC 收集。这种问题经常会导致 GC 调整无法成功。</p>
<p>只有正确监视缓存指标或堆转储才能帮助确定问题的根本原因。</p>
<ul>
<li>流失率和高事务内存使用率</li>
</ul>
<p>分代 GC 是为大量非常短暂的对象设计的。如果事务内存使用量过高，则可能很快导致性能或稳定性问题。然而，这种类型的问题只在负载测试中观察到，并且在开发过程中很容易被忽略。</p>
<p>如果在太短的时间内创建了太多的对象，就会导致年轻一代中 GC 的数量增加，只有当大多数对象死亡时，GC 才会变得没有价值。如果有很多对象在 GC 中存活下来，那么它实际上比在类似情况下的老一代 GC 要有价值得多。因此，单个事务的高内存需求在功能测试中可能不是问题，但在负载下可能很快导致 GC 抖动。如果负载变得更高，这些事务对象将被提升到老一代，因为年轻一代变得太小。如果增加年轻代的大小，就会排除问题，但最终会导致更长时间的 GC 暂停。</p>
<p>由于高事务内存需求导致的内存不足错误是最糟糕的情况。如果内存已经紧张，那么更高的事务负载可能会使可用堆最大化。棘手的部分是，一旦 OutOfMemory 命中，想要分配对象但不能被中止的事务。随后，释放了大量内存并收集垃圾。由于大多数内存工具每隔几秒钟只查看 Java 内存，因此它们甚至可能在任何时间点都不会显示100％的内存。</p>
<p>从 Java 6 开始，可以在 OutOfMemory 事件中触发堆转储，这将显示根本原因。如果没有 OutOfMemory，趋势或组织内存转储可用于识别对象编号波动最大的类，通常是那些被分配和垃圾收集的类。最后的手段是进行全面的分配分析。</p>
<ul>
<li>大型临时对象</li>
</ul>
<p>临时对象还会导致内存不足错误或 GC 活动增加。当必须读取和处理大型文档时会发生这种情况。</p>
<p><code>code byte tmpData[] = new byte[1024]; int offs = 0; do { int readLen = bis.read(tmpData, offs, tmpData.length - offs); if(readLen == -1) break; offs += readLen; if(offs == tmpData.length) { byte newres[] = new byte[tmpData.length + 1024]; System.arraycopy(tmpData, 0, newres, 0,tmpData.length); tmpData = newres; } } while(true);</code></p>
<p>对于经验丰富的开发人员来说，很明显，由于大量不必要的分配和不断增长的复制操作，使用这样的代码处理多兆字节会导致性能不佳。很多时候，在测试期间没有注意到这样的问题，但只有在达到某个级别的并发性时才需要 GC 的数量和临时内存量，这就成了一个问题。</p>
<p>因此，在处理大型文档时，优化处理逻辑并防止其完全保留在内存中非常重要。</p>
<h2 id="class-loader">与内存相关的 Class Loader 问题</h2>
<p>在现代企业应用程序中，加载类的内存要求可能很快达到几百 MB 并导致内存问题。在 Hotspot JVM 中，类位于永久代或 PermGen 中。它代表一个单独的内存区域，其大小必须单独配置。如果此区域已满，则不能再加载类，并且 PermGen 中会出现内存不足的情况。其他 JVM 没有永久代，但这并没有解决问题。类加载器问题是一些最难检测的问题。大多数开发人员从不必处理此主题，并且该领域的工具支持也是最差的。以下是一些这样的问题：</p>
<ul>
<li>大类</li>
</ul>
<p>重要的是不要不必要地增加类的大小。当类包含很多字符串常量时（例如在 GUI 应用程序中），尤其如此。这里所有字符串都保存在常量中。这是一种很好的设计方法，但不应忘记这些常量也需要内存中的空间。对于 Hotspot JVM，字符串常量是 PermGen 的一部分，然后很快就会变得太小。</p>
<ul>
<li>内存中同一类的多个实例</li>
</ul>
<p>应用程序服务器和 OSGi 容器存在加载类过多和内存使用量过大的问题。应用程序服务器可以相互隔离地加载不同的应用程序或应用程序的一部分。一个特性是可以加载同一类的多个版本以在同一 JVM 中运行不同的应用程序。由于配置不正确，这可以使类快速增加一倍或三倍。</p>
<p>这些问题最好通过堆转储或趋势转储（jmap -histo）来诊断。如果多次加载类，则其实例也会多次计数。因此，如果相同的类出现多次且具有不同数量的实例，则已经识别出这样的问题。可以通过简单的引用跟踪在堆转储中确定负责的类加载器。类加载器的变量显示对应用程序模块和 .jar 文件的引用。这使得可以确定是否由不同的应用程序模块多次加载相同的 .jar 文件。</p>
<ul>
<li>同一个类重复加载</li>
</ul>
<p>重复加载同一类似乎在内存中不会出现两次。许多人忘记了，在所有三个大型 JVM 中，类都是垃圾收集的。Hotspot JVM 仅在主要 GC 期间执行此操作，而 IBM 和 JRockit 都可以在每个 GC 期间执行此操作。因此，如果一个类只使用了很短的时间，它可以立即再次从内存中删除。加载类并不是很便宜，通常不会针对并发性进行优化。如果多个线程加载了同一个类，Java 会同步这些线程。</p>
<p>对于 Hotspot JVM，此问题仅在负载和内存压力下发生，因为它需要主要 GC，而在 IBM JVM 或 JRockit 中，这可能已经在中等负载下发生。该类甚至可能无法在第一次垃圾收集中存活。</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        <footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
          <a href="https://jinshuju.net/f/KibUGN">立即试用 Dynatrace - 最易用的 APM/AIOps 跨云智能运维平台 </a>Powered By CECTI<br>
          本页面由 CECTI 团队维护。发现了错别字？ <a href="https://github.com/cecti/docs/issues/new">在这里提交修复</a>！
      </div>
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../../assets/javascripts/application.245445c6.js"></script>
      
        
        
          
          <script src="../../../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
                <script src="../../../../../assets/javascripts/lunr/tinyseg.js"></script>
              
              
                <script src="../../../../../assets/javascripts/lunr/lunr.ja.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../../../.."}})</script>
      
    
  </body>
</html>